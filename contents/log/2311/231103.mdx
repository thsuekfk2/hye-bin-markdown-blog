---
title: "Table of Contents ìƒì„±í•˜ì—¬ ëª©ì°¨ êµ¬í˜„"
slug: "231103"
date: "2023-11-03T00:00:00.000+00:00"
description: "Table of Contents ìƒì„±í•˜ì—¬ ëª©ì°¨ êµ¬í˜„"
thumbnail: ""
tags: []
---

ë¸”ë¡œê·¸ì˜ ê¸°ëŠ¥ ì¤‘ ëª©ì°¨ ê¸°ëŠ¥ì„ ê¼­ ë§Œë“¤ì–´ ë³´ê³  ì‹¶ì—ˆë‹¤. ğŸš€

## ëª©ì°¨ ê¸°ëŠ¥ ì„¤ëª… âœ¨

1. í˜ì´ì§€ ë‚´ì— ìˆëŠ” `h2`ì™€ `h3` ë¥¼ ì°¾ê³ , ìŠ¤í¬ë¡¤ ìœ„ì¹˜ì— ë”°ë¼ í˜„ì¬ ë³´ì´ëŠ” ì„¹ì…˜ì˜ ì œëª©ì„ ê°•ì¡°í•˜ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ì˜€ë‹¤.
2. ì´ë•Œ Intersection Observer APIë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.

## Intersection Observer?

ì‚¬ìš©ì í™”ë©´ì— ì§€ê¸ˆ ë³´ì´ëŠ” ìš”ì†Œì¸ì§€ ì•„ë‹Œì§€ë¥¼ êµ¬ë³„í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.

ì´ë•Œ, Intersection ObserverëŠ” scroll ì´ë²¤íŠ¸ê°€ ì•„ë‹ˆë‹¤.

`scroll`Â ì´ë²¤íŠ¸ëŠ” ë‹¨ì‹œê°„ì— ìˆ˜ë°±ë²ˆ, ìˆ˜ì²œë²ˆ í˜¸ì¶œë  ìˆ˜ ìˆê³  ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— ë©”ì¸ ìŠ¤ë ˆë“œ(Main Thread) ì˜í–¥ì„ ì¤€ë‹¤. ë”°ë¼ì„œ `ë””ë°”ìš´ì‹±(Debouncing)`ê³¼Â `ì“°ë¡œí‹€ë§(Throttling)`ì„ í†µí•´ ì´ëŸ¬í•œ ë¬¸ì œë¥¼ ê°œì„ ì‹œì¼œì¤˜ì•¼í•œë‹¤.

í•˜ì§€ë§Œ Intersection ObserverëŠ” ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— ë©”ì¸ ìŠ¤ë ˆë“œì— ì˜í–¥ì„ ì£¼ì§€ ì•Šìœ¼ë©´ì„œ ë³€ê²½ ì‚¬í•­ì„ ê´€ì°°í•  ìˆ˜ ìˆë‹¤.

### 1. ìƒì„±ì ì´ˆê¸°í™”

`new IntersectionObserver()`ë¥¼ í†µí•´ ê´€ì°°ì(Observer)ë¥¼ ì´ˆê¸°í™”í•˜ê³  ê´€ì°°í•  ëŒ€ìƒ([Element](https://developer.mozilla.org/ko/docs/Web/API/Element))ì„ ì§€ì •í•œë‹¤.

ìƒì„±ìëŠ” 2ê°œì˜ ì¸ìˆ˜(`callback`,Â `options`)ë¥¼ ê°€ì§„ë‹¤.

```javascript
const io = new IntersectionObserver(callback, options); // ê´€ì°°ì ì´ˆê¸°í™”
io.observe(element); // ê´€ì°°í•˜ê³ ì í•˜ëŠ” HTML ìš”ì†Œ
```

### 2. callback

ê´€ì°°í•  ëŒ€ìƒ(Target)ì´ ë“±ë¡ë˜ê±°ë‚˜ ê°€ì‹œì„±(Visibility, ë³´ì´ëŠ”ì§€ ë³´ì´ì§€ ì•ŠëŠ”ì§€)ì— ë³€í™”ê°€ ìƒê¸°ë©´ ê´€ì°°ìëŠ” ì½œë°±(Callback)ì„ ì‹¤í–‰í•œë‹¤.

ì½œë°±ì€ 2ê°œì˜ ì¸ìˆ˜(**`entries`**,Â **`observer`**)ë¥¼ ê°€ì§‘ë‹ˆë‹¤.

```javascript
const io = new IntersectionObserver((entries, observer) => {}, options);
io.observe(element);
```

**entries**

**`entries`**[IntersectionObserverEntry](https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserverEntry)Â ê°ì²´ì˜ ë¦¬ìŠ¤íŠ¸ì´ë‹¤. ë°°ì—´ í˜•ì‹ìœ¼ë¡œ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì— forEachë¥¼ ì‚¬ìš©í•´ì„œ ì²˜ë¦¬ë¥¼ í•˜ê±°ë‚˜, ë‹¨ì¼ íƒ€ê²Ÿì˜ ê²½ìš° ë°°ì—´ì¸ ì ì„ ê³ ë ¤í•´ì„œ ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼ í•œë‹¤.

### 3. **options**

**rootMargin**

ë°”ê¹¥ ì—¬ë°±(Margin)ì„ ì´ìš©í•´ Root ë²”ìœ„ë¥¼ í™•ì¥í•˜ê±°ë‚˜ ì¶•ì†Œí•  ìˆ˜ ìˆë‹¤. (pxê³¼ % í‘œí˜„ ê°€ëŠ¥)

ex) TOP, RIGHT, BOTTOM, LEFT (Â **`10px 0px 30px 0px`** )

**threshold**

ì˜µì €ë²„ê°€ ì‹¤í–‰ë˜ê¸° ìœ„í•´ íƒ€ê²Ÿì˜ ê°€ì‹œì„±ì´ ì–¼ë§ˆë‚˜ í•„ìš”í•œì§€ ë°±ë¶„ìœ¨ë¡œ í‘œì‹œí•œë‹¤.

## êµ¬í˜„í•˜ê¸°

### getIntersectionObserver í•¨ìˆ˜

```javascript
import { Dispatch, SetStateAction } from "react";

const observerOptions = {
  threshold: 0.4,
  rootMargin: "0px 0px -70% 0px",
};

export const getIntersectionObserver = (
  setState: Dispatch<SetStateAction<string>>
) => {
  const observer = new IntersectionObserver((entries) => {
    for (const entry of entries) {
      if (entry.intersectionRect.top !== 0) {
        setState(entry.target.id);
      }
    }
  }, observerOptions);

  return observer;
};
```

### Toc ì»´í¬ë„ŒíŠ¸

```javascript
"use client";

import { getIntersectionObserver } from "@/utils/observer";
import { useEffect, useState } from "react";

export const Toc = () => {
  const [currentId, setCurrentId] = useState<string>("");
  const [headingEls, setHeadingEls] = useState<Element[]>([]);

  useEffect(() => {
    const observer = getIntersectionObserver(setCurrentId);
    const headings = document.querySelectorAll("h2, h3");
    const headingElements = Array.from(headings);
    setHeadingEls(headingElements);

    headingElements.map((header) => {
      const id = header.textContent!;
      header.id = id;
      observer.observe(header);
    });
  }, []);

  return (
    <>
      <div className="absolute ml-5 left-full">
        <div className="fixed hidden text-xs xl:flex xl:flex-col max-w-[220px] gap-3 text-[#999]">
          {headingEls.map((header, i) =>
            header.nodeName === "H2" ? (
              <div
                className={`text-[12px] ${
                  currentId === header.textContent &&
                  "text-white text-[13px] transition-all duration-125 ease-in delay-0"
                }`}
                key={i}
              >
                <a href={`#${header.id}`}>{header.textContent}</a>
              </div>
            ) : (
              <div
                className={`ml-5 text-[12px] ${
                  currentId === header.textContent &&
                  "text-white text-[13px] transition-all duration-125 ease-in delay-0"
                }`}
                key={i}
              >
                <a href={`#${header.id}`}>{header.textContent}</a>
              </div>
            )
          )}
        </div>
      </div>
    </>
  );
};
```

## Reference

[https://heropy.blog/2019/10/27/intersection-observer/](https://heropy.blog/2019/10/27/intersection-observer/)

[https://blog.hyeyoonjung.com/2019/01/09/intersectionobserver-tutorial/

](https://blog.hyeyoonjung.com/2019/01/09/intersectionobserver-tutorial/)