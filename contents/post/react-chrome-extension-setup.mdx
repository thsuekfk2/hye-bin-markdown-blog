---
title: "ë¦¬ì•¡íŠ¸ë¡œ chrome extension ë§Œë“¤ê¸° (setting)"
slug: "react-chrome-extension-setup"
date: "2024-02-04T00:00:00.000+00:00"
description: "chrome extensionì„ ë§Œë“¤ì–´ ë³´ì!"
thumbnail: "https://www.hyebin.me/post/5/cover.png"
tags: []
---

## ê°œë°œ ë™ê¸°

íšŒì‚¬ì—ì„œ ì¼ë ‰íŠ¸ë¡ ìœ¼ë¡œ ì‘ìš©í”„ë¡œê·¸ë¨ì„ ë§ì•„ì„œ í¬ë¡¬ íƒ­ì„ ì œì–´í•˜ê±°ë‚˜ í™”ë©´ì„ ì œì–´í–ˆë‹¤. í•˜ì§€ë§Œ ìœ ì§€ë³´ìˆ˜ì™€ ì—…ë°ì´íŠ¸ ê³¼ì •ì´ ë§¤ìš° í˜ë“¤ì—ˆë‹¤. ë˜, í…ŒìŠ¤íŠ¸ê°€ ì‰½ì§€ ì•Šì•˜ìœ¼ë©°, ë…¸íŠ¸ë¶ ê¸°ì¢…, ì—…ë°ì´íŠ¸ í™˜ê²½ ë“±.. ì„¤ì¹˜ ìì²´ê°€ ì•ˆë˜ëŠ” ì´ìŠˆë„ ë§ì•˜ë‹¤.

ì¢€ ë” ê°€ë³ê³  í¬ë¡¬ ê¸°ë°˜ì˜ í•˜ë“œì›¨ì–´ë¥¼ ì œì–´í•˜ëŠ” í”„ë¡œê·¸ë¨ì€ ì—†ì„ê¹Œ ê³ ë¯¼í•˜ë‹¤ chrome extensionìœ¼ë¡œ íƒ­ì„ ì œì–´í•˜ëŠ” ë°©ë²•ì´ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œê²Œë˜ì—ˆë‹¤. ì„¤ì¹˜ë„ ê°€ë³ê³ , ì—…ë°ì´íŠ¸ë„ ì‰½ê²Œ ê°€ëŠ¥ í•˜ê¸° ë•Œë¬¸ì— ì´ë²ˆ ê¸°íšŒì— reactì™€ typescriptë¥¼ ì´ìš©í•˜ì—¬ chrome extensionì„ ë§Œë“¤ì–´ ë³´ì•˜ë‹¤.

## Setting

### vite ì„¤ì¹˜í•˜ê¸°

```bash
npm create vite@latest exe_app -- --template react-ts
```

### [CRXJS](https://crxjs.dev/) ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜í•˜ê¸°

CRXJSëŠ” Chrome í™•ì¥ í”„ë¡œê·¸ë¨ì„ ê°œë°œí•  ë•Œ ì‚¬ìš©ë˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¤‘ í•˜ë‚˜ë‹¤.

1. HMRê¸°ëŠ¥ìœ¼ë¡œ ë‹¤ì‹œ ë¹Œë“œí•˜ì§€ ì•Šê³ ë„ ìµìŠ¤í…ì…˜ì„ ë¡œë“œë§Œ í•˜ë©´ ë³€ê²½ì‚¬í•­ì´ ë°”ë¡œ ì ìš©ëœë‹¤.
2. CRXJS + Vite í”ŒëŸ¬ê·¸ì¸ì„ í™œìš©í•˜ë©´ ê°„ë‹¨í•˜ê³  ì‰½ê²Œ Chrome í™•ì¥ í”„ë¡œê·¸ë¨ ê°œë°œì´ ê°€ëŠ¥í•˜ë‹¤.

```bash
npm i @crxjs/vite-plugin@beta -D
```

CRXJS ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì ìš©ì‹œì¼œì¤€ë‹¤.

```javascript
// vite.config.js
import { defineConfig } from "vite";
import react from "@vitejs/plugin-react";
import { crx } from "@crxjs/vite-plugin";
import manifest from "./manifest.json";

export default defineConfig({
  plugins: [
    react(),
    crx({ manifest }),
    (server: {
      port: 3000,
    }),
  ],
});
```

## mainfest ì„¤ì •

chrome extensionì˜ í•µì‹¬ì´ë¼ê³  í•  ìˆ˜ ìˆëŠ” íŒŒì¼ì¸ `manifest.json` ì€ ë¸Œë¼ìš°ì €ì— ì´ ì•±ì— ëŒ€í•œ ì •ë³´ë¥¼ ì•Œë ¤ì£¼ëŠ” íŒŒì¼ì´ë‹¤. ì´ ì•±ì´ í¬ë¡¬ ìµìŠ¤í…ì…˜ì´ë¼ê³  ë¸Œë¼ìš°ì €ì— ëª…ì‹œë¥¼ í•´ì¤˜ì•¼, extension í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

Chrome Extension Appì˜ ê·œê²©ì— ë§ê²Œ manifest.json íŒŒì¼ì„ ìˆ˜ì •í•´ë³´ì. ì•„ë˜ í•„ë“œëŠ” í•„ìˆ˜ì ìœ¼ë¡œ ë„£ì–´ì¤˜ì•¼ í•˜ëŠ” ê°’ë“¤ë¡œ, í•˜ë‚˜ë¼ë„ ì—†ìœ¼ë©´ extension ì•±ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ì—†ë‹¤.

- manifest_version: manifest ë²„ì „ìœ¼ë¡œ 2023.05 ê¸°ì¤€ìœ¼ë¡œ v3ì´ ê°€ì¥ ìµœê·¼ ë²„ì „ì´ë‹¤. í˜„ì¬ëŠ” ìŠ¤í† ì–´ì— ì˜¬ë¦¬ë ¤ë©´ ë¬´ì¡°ê±´ 3ë²„ì „ìœ¼ë¡œë§Œ ê°€ëŠ¥í•˜ë‹¤
- version: ì•±ì˜ ë²„ì „ì„ ëœ»í•œë‹¤.
- name: ì‚¬ìš©ìì—ê²Œ í‘œì‹œë˜ëŠ” chrome extensionì˜ ì´ë¦„ì„ ëœ» í•œë‹¤
- action > default_popup: ì§„ì…ì (entry point)ë¥¼ ì„¤ì •í•œë‹¤

```json
{
  "manifest_version": 3,
  "version": "1.0.0",
  "short_name": "React App",
  "name": "Create React App",
  "action": {
    "default_popup": "index.html"
  }
}
```

## ì•„ì´ì½˜ ì„¤ì •

manifest.jsonì˜ action í•„ë“œ ì„¤ì •ì„ ì¶”ê°€í•˜ë©´ ì•„ì´ì½˜ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

- default_icon: chrome extensionì•„ì´ì½˜ ì„¤ì •
- default_title: extensionì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¸ì„ ë•Œ, ë‚˜ì˜¤ëŠ” íˆ´íŒ
- default_popup: entry point

```json
{
  "action": {
    "default_icon": {
      "16": "images/icon16.png",
      "24": "images/icon24.png",
      "32": "images/icon32.png"
    },
    "default_title": "Click Me",
    "default_popup": "index.html"
  }
}
```

## Chrome extension ì»´í¬ë„ŒíŠ¸

extensionì—ëŠ” ì„¸ê°€ì§€ ë©”ì¸ ì»´í¬ë„ŒíŠ¸ê°€ ìˆë‹¤.

- Popup : Popupì€ extension iconì„ ëˆ„ë¥´ë©´ ëœ¨ëŠ” ì½˜í…ì¸ ì´ë‹¤. popup í˜•íƒœì˜ chrome extensionì€ ë„ˆë¹„ 800px ë†’ì´ 600pxì„ ìµœëŒ€ë¡œ ê°€ì§€ê²Œ ëœë‹¤. ë§Œì•½ ì´ ë„ˆë¹„/ë†’ì´ë³´ë‹¤ í° ê²½ìš°, ìŠ¤í¬ë¡¤ì´ ìƒê¸´ë‹¤.
- Content : Content scriptëŠ” íŠ¹ì • í˜ì´ì§€ì—ì„œ ì‹¤í–‰ë  scriptë¥¼ ì„¤ì •í•œë‹¤.
- Background: Background scriptëŠ” ë¸Œë¼ìš°ì €ì—ì„œ ë¶„ë¦¬ëœ ì¸ìŠ¤í„´ìŠ¤ë¡œ ì‹¤í–‰ë˜ëŠ” javascript ì½”ë“œì´ë‹¤. ê±°ì˜ ì´ë²¤íŠ¸ë¥¼ listeningí•˜ê³ , ë¸Œë¼ìš°ì €ë¥¼ ë‹¤ë£¨ê¸° ìœ„í•´ì„œ ì‚¬ìš©ëœë‹¤.

ë”°ë¼ì„œ ìš°ë¦¬ê°€ í•„ìš”í•  íŒŒì¼ì€ popup.htmlì— ë“¤ì–´ê°ˆ popup.js(ë³´í†µì˜ react í”„ë¡œì íŠ¸ì—ì„œì˜ index.js), background.js, content.js ì´ë‹¤.

ë‚˜ëŠ” ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¡œ ë§Œë“¤ì—ˆë‹¤. pages ì•ˆì— background, content, popupìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ë¥¼ ë‚˜ëˆ„ì—ˆë‹¤.

![gif](/post/5/dir.png)

## Extension Manifest

CRXJSë¥¼ ì´ìš©í•˜ë©´ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ë¥¼ Vite êµ¬ì„±ìœ¼ë¡œ ê°€ì ¸ì˜¤ê¸° ë•Œë¬¸ì— JSON, JavaScript ë˜ëŠ” TypeScriptë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

ë‚˜ëŠ” manifest.jsonì„ manifest.config.tsë¡œ ë‹¤ìŒê³¼ ê°™ì´ ë§Œë“¤ì—ˆë‹¤.

```javascript
import { defineManifest } from "@crxjs/vite-plugin";

import packageJson from "./package.json";
const { version } = packageJson;

const [major, minor, patch, label = "0"] = version
  .replace(/[^\d.-]+/g, "")
  .split(/[.-]/);

export default defineManifest(async (env) => ({
  manifest_version: 3,
  name: env.mode === "staging" ? "[INTERNAL] Tools - EXE" : "Tools - EXE",
  description: "ì‘ìš©í”„ë¡œê·¸ë¨ EXE App",
  version:
    label === "0"
      ? `${major}.${minor}.${patch}`
      : `${major}.${minor}.${patch}.${label}`,
  version_name: version,
  action: {
    default_title: "popup",
    default_popup: "src/pages/popup/index.html",
  },
  icons: {
    16: "image1.png",
    48: "image2.png",
    128: "image3.png",
  },
  background: {
    service_worker: "src/pages/background/index.ts",
    type: "module",
  },
  content_scripts: [
    {
      matches: ["http://localhost:3000/*"],
      js: ["src/pages/content/main.tsx"],
    },
  ],
  web_accessible_resources: [
    {
      resources: ["assets/js/*.js", "assets/css/*.css"],
      matches: ["*://*/*"],
    },
  ],
  permissions: ["storage", "scripting", "activeTab"],
}));
```

ê·¸ë¦¬ê³  vite.config.ts ë„ ìˆ˜ì •í•´ì£¼ì—ˆë‹¤.

```javascript
import react from "@vitejs/plugin-react";
import { defineConfig } from "vite";
import { crx } from "@crxjs/vite-plugin";
import manifest from "./manifest.config";

export default defineConfig({
  plugins: [react(), crx({ manifest })],
  server: {
    port: 3000,
  },
});
```

## chrome extension ë“±ë¡

manifest ì„¤ì •ì´ ì™„ë£Œë˜ì—ˆìœ¼ë©´, react í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•œë‹¤. ë¹Œë“œëœ ì‚°ì¶œë¬¼ì„ ë¡œì»¬ chrome ë¸Œë¼ìš°ì €ì— extensionì„ ì¶”ê°€í•´ ì£¼ì–´ì•¼ í•œë‹¤.

1. chrome://extensions/ ìœ¼ë¡œ ë“¤ì–´ê°€ ìš°ì¸¡ ìƒë‹¨ì— "ê°œë°œì ëª¨ë“œ"ë¥¼ í™œì„±í™” í•´ì¤€ë‹¤.
2. "ì••ì¶•í•´ì œëœ í™•ì¥ í”„ë¡œê·¸ë¨ì„ ë¡œë“œí•©ë‹ˆë‹¤." ë¥¼ í´ë¦­í•˜ì—¬ ë¹Œë“œ dist í´ë”ë¥¼ ì„ íƒí•œë‹¤.
3. ì¶”ê°€ëœ í¬ë¡¬ extensionì„ í™•ì¸í•˜ê³ , í•€ ê³ ì •ì„ í•œë‹¤. ê·¸ë¦¬ê³  í´ë¦­í•˜ë©´ default_popì— ì„¤ì •í•œ index.html ì´ ë³´ì¸ë‹¤.

ë‹¤ìŒ í¬ìŠ¤íŒ…ì€ ê¸°ëŠ¥ ìœ„ì£¼ë¡œ ì¨ë´ì•¼ê² ë‹¤ ğŸš€

## ì°¸ê³ 

- [https://crxjs.dev/](https://crxjs.dev/)
- [https://bluemiv.tistory.com/7](https://bluemiv.tistory.com/7)
- [https://ryuing.tistory.com/73](https://ryuing.tistory.com/73)
- [https://dev.to/cookiemonsterdev/chrome-extension-using-vite-react-3bhj](https://dev.to/cookiemonsterdev/chrome-extension-using-vite-react-3bhj)